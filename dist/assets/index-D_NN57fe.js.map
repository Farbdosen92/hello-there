{"version":3,"file":"index-D_NN57fe.js","sources":["../../node_modules/lucide-react/dist/esm/icons/arrow-up-right.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/scan-line.js","../../src/pages/dashboard/index.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.563.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M7 7h10v10\", key: \"1tivn9\" }],\n  [\"path\", { d: \"M7 17 17 7\", key: \"1vkiza\" }]\n];\nconst ArrowUpRight = createLucideIcon(\"arrow-up-right\", __iconNode);\n\nexport { __iconNode, ArrowUpRight as default };\n//# sourceMappingURL=arrow-up-right.js.map\n","/**\n * @license lucide-react v0.563.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.563.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 7V5a2 2 0 0 1 2-2h2\", key: \"aa7l1z\" }],\n  [\"path\", { d: \"M17 3h2a2 2 0 0 1 2 2v2\", key: \"4qcy5o\" }],\n  [\"path\", { d: \"M21 17v2a2 2 0 0 1-2 2h-2\", key: \"6vwrx8\" }],\n  [\"path\", { d: \"M7 21H5a2 2 0 0 1-2-2v-2\", key: \"ioqczr\" }],\n  [\"path\", { d: \"M7 12h10\", key: \"b7w52i\" }]\n];\nconst ScanLine = createLucideIcon(\"scan-line\", __iconNode);\n\nexport { __iconNode, ScanLine as default };\n//# sourceMappingURL=scan-line.js.map\n","import { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Card } from \"@/components/ui/card\";\nimport { Users, ScanLine, ArrowUpRight, DollarSign } from \"lucide-react\";\nimport { supabase } from \"@/lib/supabase/client\";\nimport { useAuth } from \"@/contexts/auth-context\";\n\ninterface DashboardData {\n    scansCount: number;\n    leadsCount: number;\n    chipsCount: number;\n    recentScans: any[];\n}\n\nexport default function DashboardPage() {\n    const { user } = useAuth();\n    const [data, setData] = useState<DashboardData>({\n        scansCount: 0,\n        leadsCount: 0,\n        chipsCount: 0,\n        recentScans: [],\n    });\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        async function fetchDashboardData() {\n            if (!user) return;\n\n            // Get user's profile to check company\n            const { data: userProfile } = await supabase\n                .from(\"users\")\n                .select(\"id, company_id\")\n                .eq(\"id\", user.id)\n                .single();\n\n            // Get user's chip IDs first\n            let chipsQuery = supabase.from(\"chips\").select(\"id\");\n            if (userProfile?.company_id) {\n                chipsQuery = chipsQuery.eq(\"company_id\", userProfile.company_id);\n            } else {\n                chipsQuery = chipsQuery.eq(\"assigned_user_id\", user.id);\n            }\n            const { data: userChips } = await chipsQuery;\n            const chipIds = userChips?.map((c) => c.id) || [];\n\n            // Now fetch counts filtered by user's chips\n            const [scansResult, leadsResult, recentScansResult] = await Promise.all([\n                chipIds.length > 0\n                    ? supabase.from(\"scans\").select(\"*\", { count: \"exact\", head: true }).in(\"chip_id\", chipIds)\n                    : Promise.resolve({ count: 0 }),\n                supabase.from(\"leads\").select(\"*\", { count: \"exact\", head: true }).eq(\"captured_by_user_id\", user.id),\n                chipIds.length > 0\n                    ? supabase.from(\"scans\").select(\"*\").in(\"chip_id\", chipIds).order(\"scanned_at\", { ascending: false }).limit(5)\n                    : Promise.resolve({ data: [] }),\n            ]);\n\n            setData({\n                scansCount: scansResult.count || 0,\n                leadsCount: leadsResult.count || 0,\n                chipsCount: chipIds.length,\n                recentScans: recentScansResult.data || [],\n            });\n            setLoading(false);\n        }\n\n        fetchDashboardData();\n    }, [user]);\n\n    if (loading) {\n        return (\n            <div className=\"flex items-center justify-center h-64\">\n                <div className=\"h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\" />\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-8\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Dashboard</h1>\n                <div className=\"flex items-center gap-2\">\n                    <div className=\"h-2 w-2 rounded-full bg-green-500 animate-pulse\" />\n                    <span className=\"text-sm text-zinc-400\">System Online</span>\n                </div>\n            </div>\n\n            {/* Stats Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                <StatsCard title=\"Gesamt Scans\" value={data.scansCount} change=\"Gesamtzeit\" icon={ScanLine} />\n                <StatsCard title=\"Aktive Kontakte\" value={data.leadsCount} change=\"Erfasste Kontakte\" icon={Users} />\n                <StatsCard title=\"Aktive Chips\" value={data.chipsCount} change=\"Verteilte Geräte\" icon={ArrowUpRight} />\n                <StatsCard title=\"Umsatz\" value=\"0€\" change=\"Platzhalter\" icon={DollarSign} />\n            </div>\n\n            {/* Charts Section */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                <Card className=\"bg-zinc-900 border-white/5 p-6 h-[400px]\">\n                    <h3 className=\"font-semibold mb-4\">Live Scan Feed</h3>\n                    <div className=\"text-zinc-500 text-sm\">\n                        <div className=\"space-y-4 mt-4\">\n                            {data.recentScans.slice(0, 5).map((scan: any) => (\n                                <div key={scan.id} className=\"flex items-center justify-between border-b border-white/5 pb-2\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"h-8 w-8 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400\">\n                                            <ScanLine size={14} />\n                                        </div>\n                                        <div>\n                                            <p className=\"text-sm font-medium text-white\">{scan.device_type || \"Unknown Device\"}</p>\n                                            <p className=\"text-xs text-zinc-500\">{new Date(scan.scanned_at).toLocaleTimeString()}</p>\n                                        </div>\n                                    </div>\n                                    <span className=\"text-xs text-zinc-600\">{scan.ip_address}</span>\n                                </div>\n                            ))}\n                            {!data.recentScans.length && <p>Noch keine Scans.</p>}\n                        </div>\n                    </div>\n                </Card>\n\n                <Card className=\"bg-zinc-900 border-white/5 p-6 h-[400px] flex flex-col\">\n                    <div className=\"flex items-center justify-between mb-6\">\n                        <h3 className=\"font-semibold\">Performance (30 Tage)</h3>\n                        <Link to=\"/dashboard/analytics\" className=\"text-xs text-blue-400 hover:underline\">\n                            Details\n                        </Link>\n                    </div>\n                    <div className=\"flex-1 flex items-center justify-center flex-col gap-4\">\n                        <div className=\"text-center\">\n                            <h4 className=\"text-4xl font-bold text-white mb-1\">{data.scansCount}</h4>\n                            <p className=\"text-zinc-500 text-sm\">Scans Gesamt</p>\n                        </div>\n                        <div className=\"w-full bg-white/5 h-32 rounded-lg flex items-end px-4 gap-2 pb-2\">\n                            {[40, 60, 30, 80, 50, 90, 70].map((h, i) => (\n                                <div\n                                    key={i}\n                                    className=\"flex-1 bg-blue-500/20 rounded-t-sm hover:bg-blue-500/50 transition-all\"\n                                    style={{ height: `${h}%` }}\n                                />\n                            ))}\n                        </div>\n                        <p className=\"text-xs text-zinc-600\">Mini-Preview. Für Details siehe Analytics.</p>\n                    </div>\n                </Card>\n            </div>\n        </div>\n    );\n}\n\nfunction StatsCard({ title, value, change, icon: Icon }: any) {\n    return (\n        <Card className=\"bg-zinc-900 border-white/5 p-6\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <p className=\"text-sm font-medium text-zinc-400\">{title}</p>\n                    <h2 className=\"text-2xl font-bold mt-2\">{value}</h2>\n                </div>\n                <div className=\"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center text-zinc-400\">\n                    <Icon size={20} />\n                </div>\n            </div>\n            <p className=\"text-xs text-zinc-500 mt-4\">{change}</p>\n        </Card>\n    );\n}\n"],"names":["__iconNode","ArrowUpRight","createLucideIcon","DollarSign","ScanLine","DashboardPage","user","useAuth","data","setData","useState","loading","setLoading","useEffect","fetchDashboardData","userProfile","supabase","chipsQuery","userChips","chipIds","c","scansResult","leadsResult","recentScansResult","jsx","jsxs","StatsCard","Users","Card","scan","Link","h","title","value","change","Icon"],"mappings":"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","x_google_ignoreList":[0,1,2]}