import{c as u,u as N,r as h,j as e,U as y,L as w,s as l}from"./index-Bzt5sERx.js";import{C as m}from"./card-CHUrpDkz.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],z=u("arrow-up-right",_);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],S=u("dollar-sign",k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],p=u("scan-line",C);function q(){const{user:a}=N(),[s,r]=h.useState({scansCount:0,leadsCount:0,chipsCount:0,recentScans:[]}),[o,j]=h.useState(!0);return h.useEffect(()=>{async function t(){if(!a)return;const{data:i}=await l.from("users").select("id, company_id").eq("id",a.id).single();let n=l.from("chips").select("id");i!=null&&i.company_id?n=n.eq("company_id",i.company_id):n=n.eq("assigned_user_id",a.id);const{data:x}=await n,c=(x==null?void 0:x.map(v=>v.id))||[],[f,g,b]=await Promise.all([c.length>0?l.from("scans").select("*",{count:"exact",head:!0}).in("chip_id",c):Promise.resolve({count:0}),l.from("leads").select("*",{count:"exact",head:!0}).eq("captured_by_user_id",a.id),c.length>0?l.from("scans").select("*").in("chip_id",c).order("scanned_at",{ascending:!1}).limit(5):Promise.resolve({data:[]})]);r({scansCount:f.count||0,leadsCount:g.count||0,chipsCount:c.length,recentScans:b.data||[]}),j(!1)}t()},[a]),o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-sm text-zinc-400",children:"System Online"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{title:"Gesamt Scans",value:s.scansCount,change:"Gesamtzeit",icon:p}),e.jsx(d,{title:"Aktive Kontakte",value:s.leadsCount,change:"Erfasste Kontakte",icon:y}),e.jsx(d,{title:"Aktive Chips",value:s.chipsCount,change:"Verteilte Geräte",icon:z}),e.jsx(d,{title:"Umsatz",value:"0€",change:"Platzhalter",icon:S})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(m,{className:"bg-zinc-900 border-white/5 p-6 h-[400px]",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Live Scan Feed"}),e.jsx("div",{className:"text-zinc-500 text-sm",children:e.jsxs("div",{className:"space-y-4 mt-4",children:[s.recentScans.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between border-b border-white/5 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400",children:e.jsx(p,{size:14})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t.device_type||"Unknown Device"}),e.jsx("p",{className:"text-xs text-zinc-500",children:new Date(t.scanned_at).toLocaleTimeString()})]})]}),e.jsx("span",{className:"text-xs text-zinc-600",children:t.ip_address})]},t.id)),!s.recentScans.length&&e.jsx("p",{children:"Noch keine Scans."})]})})]}),e.jsxs(m,{className:"bg-zinc-900 border-white/5 p-6 h-[400px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Performance (30 Tage)"}),e.jsx(w,{to:"/dashboard/analytics",className:"text-xs text-blue-400 hover:underline",children:"Details"})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center flex-col gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-4xl font-bold text-white mb-1",children:s.scansCount}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"Scans Gesamt"})]}),e.jsx("div",{className:"w-full bg-white/5 h-32 rounded-lg flex items-end px-4 gap-2 pb-2",children:[40,60,30,80,50,90,70].map((t,i)=>e.jsx("div",{className:"flex-1 bg-blue-500/20 rounded-t-sm hover:bg-blue-500/50 transition-all",style:{height:`${t}%`}},i))}),e.jsx("p",{className:"text-xs text-zinc-600",children:"Mini-Preview. Für Details siehe Analytics."})]})]})]})]})}function d({title:a,value:s,change:r,icon:o}){return e.jsxs(m,{className:"bg-zinc-900 border-white/5 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-400",children:a}),e.jsx("h2",{className:"text-2xl font-bold mt-2",children:s})]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center text-zinc-400",children:e.jsx(o,{size:20})})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-4",children:r})]})}export{q as default};
//# sourceMappingURL=index-D_NN57fe.js.map
